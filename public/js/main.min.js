/*! rise-explorer 1.1.0 */

angular.module("lisk_explorer",["ngAnimate","ngResource","ngRoute","ngProgress","ui.bootstrap","gettext","monospaced.qrcode","lisk_explorer.system","lisk_explorer.socket","lisk_explorer.blocks","lisk_explorer.transactions","lisk_explorer.address","lisk_explorer.search","lisk_explorer.tools","lisk_explorer.currency"]),angular.module("lisk_explorer.system",[]),angular.module("lisk_explorer.socket",[]),angular.module("lisk_explorer.blocks",[]),angular.module("lisk_explorer.transactions",[]),angular.module("lisk_explorer.address",[]),angular.module("lisk_explorer.search",[]),angular.module("lisk_explorer.tools",["naturalSort"]),angular.module("lisk_explorer.currency",[]),angular.module("lisk_explorer.tools").controller("ActivityGraph",function(activityGraph,$scope){activityGraph($scope)}),angular.module("lisk_explorer.address").controller("AddressController",function($scope,$rootScope,$routeParams,$location,$http,addressTxs){$scope.getAddress=function(){$http.get("/api/getAccount",{params:{address:$routeParams.address}}).then(function(resp){if(!resp.data.success)throw"Account was not found!";$scope.address=resp.data}).catch(function(error){$location.path("/")})},$scope.address={address:$routeParams.address},$scope.getAddress(),$scope.txs=addressTxs($routeParams.address)}),angular.module("lisk_explorer.blocks").controller("BlocksController",function($scope,$rootScope,$routeParams,$location,$http,blockTxs){$scope.getLastBlocks=function(n){var offset=0;n&&(offset=20*(n-1)),$http.get("/api/getLastBlocks?n="+offset).then(function(resp){resp.data.success?($scope.blocks=resp.data.blocks,resp.data.pagination&&($scope.pagination=resp.data.pagination)):$scope.blocks=[]})},$scope.getBlock=function(blockId){$http.get("/api/getBlock",{params:{blockId:blockId}}).then(function(resp){if(!resp.data.success)throw"Block was not found!";$scope.block=resp.data.block}).catch(function(error){$location.path("/")})},$routeParams.blockId?($scope.block={id:$routeParams.blockId},$scope.getBlock($routeParams.blockId),$scope.txs=blockTxs($routeParams.blockId)):$routeParams.page?$scope.getLastBlocks($routeParams.page):$scope.getLastBlocks()}),angular.module("lisk_explorer.currency").controller("CurrencyController",function($scope,$rootScope){$rootScope.currency.symbol=localStorage&&localStorage.getItem("rise_explorer-currency")||"RISE",$scope.setCurrency=function(currency){$rootScope.currency.symbol=currency,localStorage&&localStorage.setItem("rise_explorer-currency",currency)}}),angular.module("lisk_explorer.tools").controller("DelegateMonitor",function(delegateMonitor,orderBy,$scope,$rootScope,$http){delegateMonitor($scope),$scope.getStandby=function(n){var offset=0;n&&(offset=20*(n-1)),$scope.standbyDelegates=null,$http.get("/api/delegates/getStandby?n="+offset).then(function(resp){resp.data.success&&(_.each(resp.data.delegates,function(d){d.proposal=_.find($rootScope.delegateProposals,function(p){return p.name===d.username.toLowerCase()})}),$scope.standbyDelegates=resp.data.delegates),resp.data.pagination&&($scope.pagination=resp.data.pagination)})},$scope.getStandby(1),$scope.tables={active:orderBy("rate"),standby:orderBy("rate")}}),angular.module("lisk_explorer.system").controller("FooterController",function($scope){}),angular.module("lisk_explorer.system").controller("HeaderController",function(header,$scope,$http){$scope.getWalletAddress=function(){$http.get("/api/wallet").then(function(resp){resp.data&&($scope.walletAddress=resp.data.walletAddress)})},$scope.getWalletAddress(),header($scope)}),angular.module("lisk_explorer.system").controller("IndexController",function($scope,$http,$interval){$scope.getLastBlocks=function(){$http.get("/api/getLastBlocks").then(function(resp){resp.data.success&&($scope.blocks&&$scope.blocks.length>0?$scope.blocks[0].id!==resp.data.blocks[0].id&&($scope.blocks=resp.data.blocks):$scope.blocks=resp.data.blocks)})},$scope.blocksInterval=$interval(function(){$scope.getLastBlocks()},3e4),$scope.getLastBlocks(),$scope.getLastTransactions=function(){$http.get("/api/getLastTransactions").then(function(resp){resp.data.success&&($scope.txs&&$scope.txs.length>0?$scope.txs[0]!==resp.data.transactions[0]&&($scope.txs=resp.data.transactions):$scope.txs=resp.data.transactions)})},$scope.transactionsInterval=$interval(function(){$scope.getLastTransactions()},3e4),$scope.getLastTransactions()}),angular.module("lisk_explorer.tools").controller("MarketWatcher",function(marketWatcher,$scope){marketWatcher($scope)}),angular.module("lisk_explorer.tools").controller("NetworkMonitor",function(networkMonitor,$scope){networkMonitor($scope)}),angular.module("lisk_explorer.search").controller("SearchController",function($scope,$routeParams,$location,$timeout,Global,$http){$scope.loading=!1,$scope.badQuery=!1;var _badQuery=function(){$scope.badQuery=!0,$timeout(function(){$scope.badQuery=!1},2e3)},_resetSearch=function(){$scope.q="",$scope.loading=!1};$scope.search=function(){$scope.badQuery=!1,$scope.loading=!0,$http.get("/api/search",{params:{id:$scope.q}}).then(function(resp){!1===resp.data.success?($scope.loading=!1,_badQuery()):resp.data.id&&($scope.loading=!1,_resetSearch(),$location.path("/"+resp.data.type+"/"+resp.data.id))})}}),angular.module("lisk_explorer.address").controller("TopAccounts",function($scope,lessMore){$scope.topAccounts=lessMore({url:"/api/getTopAccounts",key:"accounts"})}),angular.module("lisk_explorer.transactions").controller("TransactionsController",function($scope,$rootScope,$routeParams,$location,$http){$scope.getTransaction=function(){$http.get("/api/getTransaction",{params:{transactionId:$routeParams.txId}}).then(function(resp){if(!resp.data.success)throw"Transaction was not found!";$scope.tx=resp.data.transaction}).catch(function(error){$location.path("/")})},$scope.getTransaction()});var ZeroClipboard=window.ZeroClipboard;angular.module("lisk_explorer").directive("clipCopy",function(){return ZeroClipboard.config({moviePath:"/swf/ZeroClipboard.swf",trustedDomains:["*"],allowScriptAccess:"always",forceHandCursor:!0}),{restric:"A",scope:{clipCopy:"=clipCopy"},template:'<div class="tooltip fade right in"><div class="tooltip-arrow"></div><div class="tooltip-inner">Copied!</div></div>',link:function(scope,elm){var clip=new ZeroClipboard(elm);clip.on("load",function(client){var onMousedown=function(client){client.setText(scope.clipCopy)};client.on("mousedown",onMousedown),scope.$on("$destroy",function(){client.off("mousedown",onMousedown)})}),clip.on("noFlash wrongflash",function(){return elm.remove()})}}}),angular.module("lisk_explorer.tools").directive("forgingStatus",function($sce){return{restrict:"A",scope:{forgingStatus:"=forgingStatus"},templateUrl:"/views/delegateMonitor/forgingStatus.html",replace:!0,transclude:!0,link:function(scope,element,attr){var updateStatus=(element[0],function(){switch(element.removeClass("fa-circle-o").addClass("fa-circle"),scope.tooltip={},scope.forgingStatus.code){case 3:element.removeClass("fa-circle red orange").addClass("fa-circle-o green"),scope.tooltip.html='<span class="avaiting-slot">Awaiting slot</span>',scope.tooltip.class="tooltip-grey";break;case 4:element.removeClass("fa-circle green red").addClass("fa-circle-o orange"),scope.tooltip.html='<span class="avaiting-slot">Awaiting slot</span>',scope.tooltip.class="tooltip-grey";break;case 0:element.removeClass("red orange").addClass("green"),scope.tooltip.html='<span class="forging">Forging</span>',scope.tooltip.class="tooltip-green";break;case 1:element.removeClass("red green").addClass("orange"),scope.tooltip.html='<span class="missed-block">Missed block</span>',scope.tooltip.class="tooltip-orange";break;case 2:element.removeClass("orange green").addClass("red"),scope.tooltip.html='<span class="not-forging">Not forging</span>',scope.tooltip.class="tooltip-red";break;default:element.removeClass("fa-circle red orange green").addClass("fa-circle-o"),scope.tooltip.html='<span class="awaiting-status">Awaiting status</span>',scope.tooltip.class="tooltip-grey"}scope.forgingStatus.code<5&&(scope.forgingStatus.blockAt?(scope.tooltip.html+="<br> Last block forged @ "+scope.forgingStatus.lastBlock.height+"<br>",scope.tooltip.html+=moment(scope.forgingStatus.blockAt).fromNow()):scope.tooltip.html+="<br> Not forged a block yet<br>"),scope.tooltip.html=$sce.trustAsHtml(scope.tooltip.html)});scope.$watch("forgingStatus",updateStatus,!0)}}}),angular.module("lisk_explorer.tools").directive("depthChart",function($timeout){function DepthChart(scope,elm,attr){var self=this;this.style={width:"100%",height:"500px"},this.config={type:"serial",theme:"light",pathToImages:"/img/amcharts/",precision:8,colors:["#38B449","#d32f2f"],dataProvider:[{}],valueAxes:[{stackType:"regular",position:"left",dashLength:5}],graphs:[{fillAlphas:.7,lineAlpha:.5,title:"Bids",valueField:"bid"},{fillAlphas:.7,lineAlpha:.5,title:"Asks",valueField:"ask"}],marginTop:15,chartCursor:{fullWidth:!0,cursorAlpha:.1,valueBalloonsEnabled:!0,valueLineBalloonEnabled:!0,valueLineEnabled:!0,valueLineAlpha:.5,cursorColor:"#0299eb"},categoryField:"price",categoryAxis:{startOnAxis:!0,dashLength:5,labelRotation:30,labelFunction:function(n,t){return Number(t.category).toFixed(8)}}},this.updateDepth=function(){var delay=0;scope.depthChart||(delay=500,console.log("Initializing depth chart..."),scope.depthChart=AmCharts.makeChart("depthChart",self.config),scope.depthChart.categoryAxesSettings=new AmCharts.CategoryAxesSettings),$timeout(function(){"depthChart"===scope.tab&&(_.size(scope.orders.depth)>0?(scope.depthChart.dataProvider=scope.orders.depth,scope.depthChart.validateData(),console.log("Depth chart data updated"),elm.contents().css("display","block")):(console.log("Depth chart data is empty"),scope.depthChart.dataProvider=[],scope.depthChart.validateData(),elm.contents().css("display","none"),elm.prepend('<p class="amChartsEmpty"><i class="fa fa-exclamation-circle"></i> No Data</p>')),scope.$emit("$depthChartUpdated"))},delay)},elm.css("width",self.style.width),elm.css("height",self.style.height)}return{restric:"E",replace:!0,template:'<div id="depthChart"></div>',link:function(scope,elm,attr){var depthChart=new DepthChart(scope,elm,attr);scope.$on("$ordersUpdated",depthChart.updateDepth)}}}),angular.module("lisk_explorer.tools").directive("orders",function(){return{restrict:"E",scope:{orders:"=orders",heading:"@heading",name:"@name"},templateUrl:"/views/marketWatcher/orders.html",replace:!0}}),angular.module("lisk_explorer.tools").directive("peers",function(orderBy){return{restrict:"E",scope:{peers:"="},templateUrl:"/views/networkMonitor/peers.html",replace:!0,link:function(scope,element,attr){scope.table=orderBy("ip")}}}).directive("osIcon",function(){return{restrict:"A",scope:{os:"=os",brand:"=brand"},template:"<span></span>",replace:!0,link:function(scope,element,attr){var el=element[0];el.alt=el.title=scope.os,el.className+=" os-icon os-"+scope.brand.name}}}),angular.module("lisk_explorer").directive("scroll",function($window){return function(scope,element,attrs){angular.element($window).bind("scroll",function(){this.pageYOffset>=200?scope.secondaryNavbar=!0:scope.secondaryNavbar=!1,scope.$apply()})}}),angular.module("lisk_explorer.tools").directive("stockChart",function($timeout){function StockChart(scope,elm,attr){var self=this;this.style={width:"100%",height:"500px"},this.config={type:"stock",theme:"light",pathToImages:"/img/amcharts/",dataSets:[{fieldMappings:[{fromField:"date",toField:"date"},{fromField:"open",toField:"open"},{fromField:"close",toField:"close"},{fromField:"high",toField:"high"},{fromField:"low",toField:"low"},{fromField:"btcVolume",toField:"btcVolume"},{fromField:"liskVolume",toField:"liskVolume"},{fromField:"numTrades",toField:"numTrades"}],color:"#888888",dataProvider:[],categoryField:"date"}],panels:[{title:"Price",showCategoryAxis:!1,percentHeight:70,valueAxes:[{id:"v1",dashLength:5,precision:8}],categoryAxis:{dashLength:5,parseDates:!0},stockGraphs:[{type:"candlestick",id:"g1",openField:"open",closeField:"close",highField:"high",lowField:"low",valueField:"close",lineColor:"#288234",fillColors:"#38B449",negativeLineColor:"#990000",negativeFillColors:"#d32f2f",fillAlphas:.7,useDataSetColors:!1,comparable:!1,showBalloon:!0,balloonText:"Open: <b>[[open]]</b><br>Close: <b>[[close]]</b><br>Low: <b>[[low]]</b><br>High: <b>[[high]]</b>",balloonColor:"#888888",proCandlesticks:!0}]},{title:"Volume",percentHeight:30,marginTop:1,showCategoryAxis:!0,valueAxes:[{dashLength:5,precision:8}],categoryAxis:{dashLength:5,parseDates:!0},stockGraphs:[{valueField:"btcVolume",periodValue:"Sum",type:"column",showBalloon:!0,balloonText:"Volume: <b>[[value]]</b>",balloonColor:"#888888",fillAlphas:1,colors:"black",backgroundColors:"black",fillColors:"black"}]}],chartCursorSettings:{fullWidth:!0,cursorAlpha:.1,valueBalloonsEnabled:!0,valueLineBalloonEnabled:!0,valueLineEnabled:!0,valueLineAlpha:.5,cursorColor:"#0299eb"},chartScrollbarSettings:{graph:"g1",graphType:"smoothedLine"},periodSelector:{position:"bottom",periods:[]}},this.dataSets={minute:{minPeriod:"mm",groupToPeriods:["hh","DD","WW","MM","YYYY"],periods:[{period:"MAX",label:"MAX",selected:!0},{period:"hh",count:12,label:"12 Hours"},{period:"hh",count:6,label:"6 Hours"},{period:"hh",count:3,label:"3 Hours"}]},hour:{minPeriod:"hh",groupToPeriods:["DD","WW","MM","YYYY"],periods:[{period:"MAX",label:"MAX",selected:!0},{period:"MM",count:1,label:"1 Month"},{period:"WW",count:1,label:"1 Week"},{period:"DD",count:1,label:"1 Day"}]},day:{minPeriod:"DD",groupToPeriods:["WW","MM","YYYY"],periods:[{period:"MAX",label:"MAX",selected:!0},{period:"MM",count:6,label:"6 Months"},{period:"MM",count:3,label:"3 Months"},{period:"MM",count:1,label:"1 Month"}]}},this.updatePeriod=function(){var newPeriod=scope.newExchange||scope.newDuration;return newPeriod&&(console.log("Updating period selector..."),scope.stockChart.categoryAxesSettings.minPeriod=self.dataSets[scope.duration].minPeriod,scope.stockChart.periodSelector.periods=self.dataSets[scope.duration].periods,scope.stockChart.validateNow()),newPeriod},this.updateCandles=function(){var delay=0;scope.stockChart||(delay=500,console.log("Initializing stock chart..."),scope.stockChart=AmCharts.makeChart("stockChart",self.config),scope.stockChart.categoryAxesSettings=new AmCharts.CategoryAxesSettings),$timeout(function(){if("stockChart"===scope.tab){var newPeriod=self.updatePeriod(scope);_.size(scope.candles)>0?(console.log("Stock chart data updated"),scope.stockChart.dataSets[0].dataProvider=scope.candles,scope.stockChart.validateData(),elm.contents().css("display","block")):(console.log("Stock chart data is empty"),scope.stockChart.dataSets[0].dataProvider=[],scope.stockChart.validateNow(),elm.contents().css("display","none"),elm.prepend('<p class="amChartsEmpty"><i class="fa fa-exclamation-circle"></i> No Data</p>')),newPeriod&&(scope.stockChart.periodSelector.setDefaultPeriod(),console.log("Default period set")),scope.$emit("$stockChartUpdated")}},delay)},elm.css("width",self.style.width),elm.css("height",self.style.height)}return{restric:"E",replace:!0,template:'<div id="stockChart"></div>',link:function(scope,elm,attr){var stockChart=new StockChart(scope,elm,attr);scope.$on("$candlesUpdated",stockChart.updateCandles)}}}),angular.module("lisk_explorer").directive("whenScrolled",function($window){return{restric:"A",link:function(scope,elm,attr){var pageHeight,clientHeight,scrollPos;$window=angular.element($window);var handler=function(){pageHeight=window.document.documentElement.scrollHeight,clientHeight=window.document.documentElement.clientHeight,scrollPos=window.pageYOffset,pageHeight-(scrollPos+clientHeight)==0&&scope.$apply(attr.whenScrolled)};$window.on("scroll",handler),scope.$on("$destroy",function(){return $window.off("scroll",handler)})}}});var ActivityGraph=function(){function NodeSelect(sigma){this.sigma=sigma,this.color="#5bc0de",this.add=function(event){this.remove(event),this.node=event.data.node,this.prevColor=this.node.color,this.node.color=this.color,this.sigma.refresh()},this.remove=function(event){this.node&&(this.node.color=this.prevColor,this.prevColor=void 0,this.node=void 0),this.sigma.refresh()},this.selected=function(){return void 0!==this.node},this.type=function(){return this.selected()?this.node.type:void 0},this.href=function(){switch(this.type()){case 0:return"/tx/"+this.node.id;case 1:return"/block/"+this.node.id;case 2:return"/address/"+this.node.id;default:return"#"}}}function CameraMenu(camera){this.camera=camera,this.reset=function(){this.camera&&this.camera.goTo({x:0,y:0,angle:0,ratio:1})}}function Statistics(graph){this.graph=graph,this.volume=this.txs=this.blocks=this.accounts=0,this.refresh=function(){var txs=this.graph.nodesByType(0),blocks=this.graph.nodesByType(1),accounts=this.graph.nodesByType(2);this.txs=txs.size().value(),this.volume=txsVolume(txs),this.blocks=blocks.size().value(),this.beginning=minTime(blocks),this.end=maxTime(blocks),this.accounts=accounts.size().value()};var txsVolume=function(chain){return chain.reduce(function(vol,tx){return vol+=tx.amount},0).value()},minTime=function(chain){return chain.min(function(block){if(block.timestamp>0)return block.timestamp}).value().timestamp},maxTime=function(chain){return chain.max(function(block){if(block.timestamp>0)return block.timestamp}).value().timestamp}}this.loading=!0,this.blocks=0,this.maxBlocks=20,this.indexes=[],this.colors={account:"#0288d1",credit:"#7CB342",debit:"#d32f2f",block:"#f57c00",tx:"#5f696e"},this.renderer={container:"sigma-canvas",type:"canvas"},this.settings={sideMargin:1,singleHover:!0,minNodeSize:.5,maxNodeSize:16,drawLabels:!1,defaultEdgeType:"arrow"},this.sigma=new sigma({renderer:this.renderer,settings:this.settings}),this.nodeSelect=new NodeSelect(this.sigma),this.cameraMenu=new CameraMenu(this.sigma.camera),this.statistics=new Statistics(this)};ActivityGraph.prototype.refresh=function(block){block&&this.addBlock(block),this.blocks>0&&(this.loading=!1),this.sigma&&(this.sizeNodes(),this.positionNodes(),this.statistics.refresh(),this.sigma.refresh())},ActivityGraph.prototype.clear=function(){this.blocks=0,this.indexes=[],this.sigma&&this.sigma.graph.clear()},ActivityGraph.prototype.sizeNodes=function(){_.each(this.sigma.graph.nodes(),function(node){var deg=this.sigma.graph.degree(node.id);node.size=this.settings.maxNodeSize*Math.sqrt(deg)},this)},ActivityGraph.prototype.nodesByType=function(type){return _.chain(this.sigma.graph.nodes()).filter(function(node){return node.type===type})},ActivityGraph.prototype.positionNodes=function(){for(var type=0;type<3;type++){var i,nodes=this.nodesByType(type).value(),len=nodes.length,slice=2*Math.PI/len;for(i=0;i<len;i++){var angle=slice*i,node=nodes[i],graph=this.sigma.graph.nodes(node.id);graph.x=(type+1)*Math.cos(angle),graph.y=(type+1)*Math.sin(angle)}}},ActivityGraph.prototype.addNode=function(node){_.contains(this.indexes,node.id)||(node.x=Math.random(),node.y=Math.random(),this.indexes.push(node.id),this.sigma.graph.addNode(node))},ActivityGraph.prototype.addEdge=function(edge){_.contains(this.indexes,edge.id)||(this.indexes.push(edge.id),this.sigma.graph.addEdge(edge))},ActivityGraph.prototype.addTx=function(tx){_.contains(this.indexes,tx.id)||(this.addNode({id:tx.id,label:tx.id,type:0,amount:tx.amount,color:this.colors.tx,size:1}),this.indexes.push(tx.id),this.addTxSender(tx),this.addTxRecipient(tx))},ActivityGraph.prototype.addAccount=function(id){this.addNode({id:id,type:2,label:id,color:this.colors.account,size:1})},ActivityGraph.prototype.amount=function(tx,sign){return sign+tx.amount/Math.pow(10,8)+" RISE"},ActivityGraph.prototype.addTxSender=function(tx){this.addAccount(tx.senderId),this.addEdge({id:tx.id+tx.senderId+Math.random(),label:this.amount(tx,"-"),source:tx.senderId,target:tx.id,color:this.colors.debit,size:1})},ActivityGraph.prototype.addTxRecipient=function(tx){tx.recipientId&&(this.addAccount(tx.recipientId),this.addEdge({id:tx.id+tx.recipientId+Math.random(),label:this.amount(tx,"+"),source:tx.id,target:tx.recipientId,color:this.colors.credit,size:1}))},ActivityGraph.prototype.addBlock=function(block){_.contains(this.indexes,block.id)||(this.blocks+1>this.maxBlocks&&this.clear(),this.addNode({id:block.id,label:block.id,timestamp:block.timestamp,type:1,color:this.colors.block,size:1}),this.blocks++,this.indexes.push(block.id),this.addBlockGenerator(block),this.addBlockTxs(block))},ActivityGraph.prototype.addBlockGenerator=function(block){this.addAccount(block.generatorId),this.addEdge({id:block.id+block.generatorId,label:block.height.toString(),source:block.generatorId,target:block.id,color:this.colors.account,size:1})},ActivityGraph.prototype.addBlockTxs=function(block){_.isEmpty(block.transactions)||_.each(block.transactions,function(tx){this.addTx(tx),this.addEdge({id:block.id+tx.id,source:block.id,target:tx.id,color:this.colors.block,size:1})},this)},angular.module("lisk_explorer.tools").factory("activityGraph",function($socket){return function($scope){var activityGraph=new ActivityGraph,ns=$socket("/activityGraph");return $scope.activityGraph=activityGraph,$scope.nodeSelect=activityGraph.nodeSelect,$scope.cameraMenu=activityGraph.cameraMenu,$scope.statistics=activityGraph.statistics,activityGraph.sigma.bind("clickNode",function(event){$scope.$apply(function(){activityGraph.nodeSelect.add(event)})}),activityGraph.sigma.bind("clickStage doubleClickStage",function(event){$scope.$apply(function(){activityGraph.nodeSelect.remove(event)})}),ns.on("data",function(res){activityGraph.refresh(res.block)}),$scope.$on("$destroy",function(event){ns.removeAllListeners()}),$scope.$on("$locationChangeStart",function(event,next,current){ns.emit("forceDisconnect")}),activityGraph}}),angular.module("lisk_explorer.system").factory("addressTxs",function($http,$q){return function(address){var lessMore=new LessMore($http,$q,{url:"/api/getTransactionsByAddress",parent:"address",key:"transactions",address:address});return lessMore.loadMore=function(){this.getData(0,1,function(data){var changed=!1;this.results[0]&&data[0]&&(changed=this.results[0].id!==data[0].id),changed?this.reloadMore():LessMore.prototype.loadMore.call(this)}.bind(this))},lessMore}}),angular.module("lisk_explorer.system").factory("blockTxs",function($http,$q){return function(blockId){return new LessMore($http,$q,{url:"/api/getTransactionsByBlock",parent:"block",key:"transactions",blockId:blockId})}});var DelegateMonitor=function($scope,$rootScope,forgingMonitor){this.updateActive=function(active){_.each(active.delegates,function(d){d.forgingStatus=forgingMonitor.getStatus(d),d.proposal=_.find($rootScope.delegateProposals,function(p){return p.name===d.username.toLowerCase()})}),$scope.activeDelegates=active.delegates,updateForgingTotals(active.delegates),updateForgingProgress($scope.forgingTotals)},this.updateTotals=function(active){$scope.totalDelegates=active.totalCount||0,$scope.totalActive=101,$scope.totalDelegates>$scope.totalActive?$scope.totalStandby=$scope.totalDelegates-$scope.totalActive:$scope.totalStandby=0,$scope.bestForger=bestForger(active.delegates),$scope.totalForged=totalForged(active.delegates),$scope.bestProductivity=bestProductivity(active.delegates),$scope.worstProductivity=worstProductivity(active.delegates)},this.updateLastBlock=function(lastBlock){$scope.lastBlock=lastBlock.block},this.updateRegistrations=function(registrations){$scope.registrations=registrations.transactions},this.updateNextForgers=function(nextForgers){$scope.nextForgers=nextForgers},this.updateVotes=function(votes){$scope.votes=votes.transactions},this.updateApproval=function(approval){$scope.approval=approval},this.updateLastBlocks=function(delegate){_.each($scope.activeDelegates,function(d){d.forgingStatus=forgingMonitor.getStatus(d)});var existing=_.find($scope.activeDelegates,function(d){return d.publicKey===delegate.publicKey});existing&&(existing.blocksAt=delegate.blocksAt,existing.blocks=delegate.blocks,existing.forgingStatus=forgingMonitor.getStatus(delegate)),updateForgingTotals($scope.activeDelegates),updateForgingProgress($scope.forgingTotals)};var bestForger=function(delegates){if(_.size(delegates)>0)return _.max(delegates,function(d){return parseInt(d.forged)})},totalForged=function(delegates){return _.chain(delegates).map(function(d){return parseInt(d.forged)}).reduce(function(memo,num){return parseInt(memo)+parseInt(num)},0).value()},bestProductivity=function(delegates){if(_.size(delegates)>0)return _.max(delegates,function(d){return parseFloat(d.productivity)})},worstProductivity=function(delegates){if(_.size(delegates)>0)return _.min(delegates,function(d){return parseFloat(d.productivity)})},updateForgingTotals=function(delegates){$scope.forgingTotals=forgingMonitor.getforgingTotals(delegates)},updateForgingProgress=function(totals){totals.processed=forgingMonitor.getForgingProgress(totals),totals.processed>0&&($scope.forgingProgress=!0)}};angular.module("lisk_explorer.tools").factory("delegateMonitor",function($socket,$rootScope,forgingMonitor){return function($scope){var delegateMonitor=new DelegateMonitor($scope,$rootScope,forgingMonitor),ns=$socket("/delegateMonitor");return ns.on("data",function(res){res.active&&(delegateMonitor.updateActive(res.active),delegateMonitor.updateTotals(res.active)),res.lastBlock&&delegateMonitor.updateLastBlock(res.lastBlock),res.registrations&&delegateMonitor.updateRegistrations(res.registrations),res.nextForgers&&delegateMonitor.updateNextForgers(res.nextForgers),res.votes&&delegateMonitor.updateVotes(res.votes),res.approval&&delegateMonitor.updateApproval(res.approval)}),ns.on("delegate",function(res){res.publicKey&&delegateMonitor.updateLastBlocks(res)}),$scope.$on("$destroy",function(event){ns.removeAllListeners()}),$scope.$on("$locationChangeStart",function(event,next,current){ns.emit("forceDisconnect")}),delegateMonitor}});var ForgingMonitor=function(forgingStatus){this.getStatus=function(delegate){return forgingStatus(delegate)},this.getforgingTotals=function(delegates){var cnt1=_.countBy(delegates,function(d){switch(d.forgingStatus.code){case 0:case 3:return"forging";case 1:case 4:return"missedBlock";case 2:return"notForging";case 3:case 4:return"awaitingSlot";default:return"unprocessed"}}),cnt2=_.countBy(delegates,function(d){switch(d.forgingStatus.code){case 3:case 4:return"awaitingSlot";default:return"unprocessed"}});return cnt1.awaitingSlot=cnt2.awaitingSlot,cnt1},this.getForgingProgress=function(totals){var unprocessed=totals.unprocessed||0;return unprocessed+=totals.staleStatus||0,unprocessed>0?101-unprocessed:101}};angular.module("lisk_explorer.tools").service("forgingMonitor",function(forgingStatus){return new ForgingMonitor(forgingStatus)}),angular.module("lisk_explorer.tools").service("forgingStatus",function($rootScope,epochStampFilter,roundFilter){return function(delegate){var status={updatedAt:delegate.blocksAt};return delegate.blocksAt&&_.size(delegate.blocks)>0?(status.lastBlock=_.first(delegate.blocks),status.blockAt=epochStampFilter(status.lastBlock.timestamp),status.networkRound=roundFilter($rootScope.blockStatus.height),status.delegateRound=roundFilter(status.lastBlock.height),status.awaitingSlot=status.networkRound-status.delegateRound,moment().diff(delegate.blocksAt,"minutes"),moment().diff(status.blockAt,"minutes")):status.lastBlock=null,0===status.awaitingSlot?status.code=0:delegate.isRoundDelegate||1!==status.awaitingSlot?!delegate.isRoundDelegate&&status.awaitingSlot>1?status.code=2:1===status.awaitingSlot?status.code=3:2===status.awaitingSlot?status.code=4:status.blockAt&&status.updatedAt?!status.blockAt&&status.updatedAt?delegate.isRoundDelegate||1!==delegate.missedblocks?delegate.missedblocks>1?status.code=2:1===delegate.missedblocks&&(status.code=4):status.code=1:status.code=2:status.code=5:status.code=1,delegate.status=[status.code,delegate.rate].join(":"),status}}),angular.module("lisk_explorer.system").factory("Global",[function(){return!0}]).factory("Version",function($resource){return $resource("/api/version")});var Header=function($rootScope){$rootScope.currency={symbol:"RISE"},this.updateBlockStatus=function(res){res.success&&($rootScope.blockStatus={height:res.height,fee:res.fee,milestone:res.milestone,reward:res.reward,supply:res.supply,nethash:res.nethash})},this.updatePriceTicker=function(res){res.success&&($rootScope.currency.tickers=res.tickers),"RISE"===$rootScope.currency.symbol||$rootScope.currency.tickers&&$rootScope.currency.tickers.RISE&&$rootScope.currency.tickers.RISE[$rootScope.currency.symbol]||(console.log("Currency "+$rootScope.currency.symbol+" not available, fallback to RISE"),$rootScope.currency.symbol="RISE")},this.updateDelegateProposals=function(res){res.success?$rootScope.delegateProposals=res.proposals:$rootScope.delegateProposals=[]}};angular.module("lisk_explorer.system").factory("header",function($rootScope,$socket){return function($scope){var header=new Header($rootScope),ns=$socket("/header");return ns.on("data",function(res){res.status&&header.updateBlockStatus(res.status),res.ticker&&header.updatePriceTicker(res.ticker)}),ns.on("delegateProposals",function(res){res&&header.updateDelegateProposals(res)}),$scope.$on("$destroy",function(event){ns.removeAllListeners()}),header}});var LessMore=function($http,$q,params){this.$http=$http,this.$q=$q,this.url=params.url||"",this.parent=params.parent||"parent",this.key=params.key||"",this.offset=params.offset||0,this.maximum=params.maximum||2e3,this.limit=params.limit||50,angular.forEach(["url","parent","key","offset","maximum","limit"],function(key){delete params[key]}),this.params=params,this.results=[],this.splice=0,this.loading=!0,this.moreData=!1,this.lessData=!1};LessMore.prototype.disable=function(){this.moreData=this.lessData=!1},LessMore.prototype.disabled=function(){return!this.moreData&&!this.lessData},LessMore.prototype.getData=function(offset,limit,cb){var params=angular.extend({offset:offset,limit:limit},this.params);this.disable(),this.loading=!0,this.$http.get(this.url,{params:params}).then(function(resp){if(!resp.data.success||!angular.isArray(resp.data[this.key]))throw"LessMore failed to get valid response data";cb(resp.data[this.key])}.bind(this))},LessMore.prototype.anyMore=function(length){return this.limit<=1&&this.limit%length==1||length>1&&this.limit>=1&&length%this.limit==1},LessMore.prototype.spliceData=function(data){this.anyMore(angular.isArray(data)?data.length:0)?(this.moreData=!0,data.splice(-1,1)):this.moreData=!1},LessMore.prototype.acceptData=function(data){angular.isArray(data)||(data=[]),this.spliceData(data),this.results.length>0?this.results=this.results.concat(data):this.results=data,this.results.length+this.limit>this.maximum&&(this.moreData=!1),this.lessData=this.anyLess(this.results.length),this.loading=!1,this.nextOffset()},LessMore.prototype.loadData=function(){this.getData(0,this.limit+1,function(data){this.acceptData(data)}.bind(this))},LessMore.prototype.loadMore=function(){this.getData(this.offset,this.limit+1,function(data){this.acceptData(data)}.bind(this))},LessMore.prototype.reloadMore=function(){var maxOffset=this.offset+this.limit,promises=[],self=this;self.offset=0,self.results=[];for(var o=0;o<maxOffset;o+=self.limit){var params=angular.extend({offset:o,limit:self.limit+1},self.params);promises.push(self.$http.get(self.url,{params:params}))}self.$q.all(promises).then(function(responses){angular.forEach(responses,function(resp){if(!resp.data.success||!angular.isArray(resp.data[this.key]))throw"LessMore failed to reload results on change";self.acceptData(resp.data[self.key])})})},LessMore.prototype.nextOffset=function(){return this.offset+=this.limit},LessMore.prototype.prevOffset=function(){return this.offset-=this.limit},LessMore.prototype.anyLess=function(length){if(length>this.limit){var mod=length%this.limit;return this.splice=0===mod?this.limit:mod,!0}return this.splice=0,!1},LessMore.prototype.loadLess=function(){this.lessData=!1,this.moreData=!0,
angular.isArray(this.results)&&(this.results.splice(-this.splice,this.splice),this.lessData=this.anyLess(this.results.length)),this.prevOffset()},angular.module("lisk_explorer.system").factory("lessMore",function($http,$q){return function(params){return new LessMore($http,$q,params)}});var MarketWatcher=function($q,$http,$scope){var interval;$scope.exchanges=[],$scope.setTab=function(tab){if($scope.oldTab=$scope.tab,$scope.tab=tab,$scope.oldTab)switch(console.log("Switched tab from",$scope.oldTab,"to",$scope.tab),tab){case"stockChart":"stockChart"!==$scope.oldTab&&$scope.$broadcast("$candlesUpdated");break;case"depthChart":"depthChart"!==$scope.oldTab&&$scope.$broadcast("$ordersUpdated")}},$scope.setExchange=function(exchange,duration){return $scope.oldExchange=$scope.exchange,$scope.exchange=exchange||$scope.exchange||_.first($scope.exchanges),$scope.newExchange=$scope.exchange!==$scope.oldExchange,$scope.newExchange&&console.log("Changed exchange from:",$scope.oldExchange,"to:",$scope.exchange),$scope.setDuration(duration)},$scope.setDuration=function(duration){return $scope.oldDuration=$scope.duration,$scope.duration=duration||$scope.duration||"hour",$scope.newDuration=$scope.duration!==$scope.oldDuration,$scope.newDuration&&console.log("Changed duration from:",$scope.oldDuration,"to:",$scope.duration),getData()};var updateAll=function(){return $scope.newExchange||!$scope.newExchange&&!$scope.newDuration},getData=function(){console.log("New exchange:",$scope.newExchange),console.log("New duration:",$scope.newDuration),console.log("Updating all:",updateAll()),$q.all([getCandles(),getStatistics(),getOrders()]).then(function(results){results[0]&&results[0].data&&($scope.candles=results[0].data.candles,$scope.$broadcast("$candlesUpdated"),console.log("Candles updated")),results[1]&&results[1].data&&($scope.statistics=results[1].data.statistics,$scope.$broadcast("$statisticsUpdated"),console.log("Statistics updated")),results[2]&&results[2].data&&($scope.orders=results[2].data.orders,$scope.$broadcast("$ordersUpdated"),console.log("Orders updated"))})},getCandles=function(){return console.log("Retrieving candles..."),$http.get(["/api/exchanges/getCandles","?e=",angular.lowercase($scope.exchange),"&d=",$scope.duration].join(""))},getStatistics=function(){if(updateAll())return console.log("Retrieving statistics..."),$http.get(["/api/exchanges/getStatistics","?e=",angular.lowercase($scope.exchange)].join(""))},getOrders=function(){if(updateAll())return console.log("Retrieving orders..."),$http.get(["/api/exchanges/getOrders","?e=",angular.lowercase($scope.exchange)].join(""))};!function(){console.log("Retrieving exchanges..."),$http.get("/api/exchanges").then(function(result){result.data.success?($scope.exchanges=_.keys(_.pick(result.data.exchanges,function(value,key){return!!value&&key})),$scope.exchanges.length>0&&($scope.setExchange(),interval=setInterval(getData,3e4))):$scope.exchanges=[]})}(),$scope.isCollapsed=!1,$scope.$on("$locationChangeStart",function(event,next,current){clearInterval(interval)}),$scope.$on("$stockChartUpdated",function(event,next,current){$scope.newExchange=$scope.newDuration=!1})};angular.module("lisk_explorer.tools").factory("marketWatcher",function($q,$http,$socket){return function($scope){var marketWatcher=new MarketWatcher($q,$http,$scope),ns=$socket("/marketWatcher");return ns.on("data",function(res){}),$scope.$on("$destroy",function(event){ns.removeAllListeners()}),$scope.$on("$locationChangeStart",function(event,next,current){ns.emit("forceDisconnect")}),marketWatcher}});var NetworkMonitor=function($scope){function Platforms(){this.counter=[0,0,0,0],this.platforms=["Darwin","Linux","Windows"],this.detect=function(platform){angular.isNumber(platform.group)&&this.counter[parseInt(platform.group)]++},this.detected=function(){return{one:{name:this.platforms[0],counter:this.counter[1]},two:{name:this.platforms[1],counter:this.counter[2]},three:{name:this.platforms[2],counter:this.counter[3]},other:{name:null,counter:this.counter[0]}}}}function Versions(peers){this.counter=[0,0,0,0],this.versions=function(){return angular.isArray(peers)?_.uniq(_.map(peers,function(p){return p.version}).sort(),!0).reverse().slice(0,3):[]}(),this.detect=function(version){var detected=null;if(angular.isString(version))for(var i=0;i<this.versions.length;i++)if(version===this.versions[i]){detected=version,this.counter[i]++;break}null==detected&&this.counter[3]++},this.detected=function(version){return{one:{num:this.versions[0],counter:this.counter[0]},two:{num:this.versions[1],counter:this.counter[1]},three:{num:this.versions[2],counter:this.counter[2]},other:{num:null,counter:this.counter[3]}}}}function Heights(peers){this.counter=[0,0,0,0,0],this.percent=[0,0,0,0,0],this.heights=function(){function sortNumber(a,b){return b-a}return angular.isArray(peers)?_.uniq(_.map(peers,function(p){return p.height}).sort(sortNumber),!0).slice(0,4):[]}(),this.detect=function(height){var detected=null;if(height)for(var i=0;i<this.heights.length;i++)if(height===this.heights[i]){detected=height,this.counter[i]++;break}null==detected&&this.counter[4]++},this.detected=function(height){return{heights:this.heights,counter:this.counter}},this.calculatePercent=function(peers){for(var i=0;i<this.counter.length;i++)this.percent[i]=Math.round(this.counter[i]/peers.length*100);return this.percent}}this.map=new NetworkMap,this.counter=function(peers){for(var platforms=new Platforms,versions=new Versions(peers.connected),heights=new Heights(peers.connected),i=0;i<peers.connected.length;i++){var p=peers.connected[i];platforms.detect(p.osBrand),versions.detect(p.version),heights.detect(p.height)}return{connected:peers.connected.length,disconnected:peers.disconnected.length,total:peers.connected.length+peers.disconnected.length,platforms:platforms.detected(),versions:versions.detected(),heights:heights.detected(),percents:heights.calculatePercent(peers.connected)}},this.updatePeers=function(peers){$scope.peers=peers.list,$scope.counter=this.counter(peers.list),this.map.addConnected(peers.list)},this.updateLastBlock=function(lastBlock){$scope.lastBlock=lastBlock.block},this.updateBlocks=function(blocks){$scope.bestBlock=blocks.best,$scope.volume=blocks.volume}},NetworkMap=function(){this.markers={},this.options={center:L.latLng(40,0),zoom:1,minZoom:1,maxZoom:10},this.map=L.map("map",this.options),this.cluster=L.markerClusterGroup({maxClusterRadius:50}),L.Icon.Default.imagePath="/img/leaflet",L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map);var PlatformIcon=L.Icon.extend({options:{iconSize:[32,41],iconAnchor:[16,41],popupAnchor:[0,-41]}}),platformIcons={darwin:new PlatformIcon({iconUrl:"/img/leaflet/marker-icon-darwin.png"}),linux:new PlatformIcon({iconUrl:"/img/leaflet/marker-icon-linux.png"}),win:new PlatformIcon({iconUrl:"/img/leaflet/marker-icon-win.png"}),freebsd:new PlatformIcon({iconUrl:"/img/leaflet/marker-icon-freebsd.png"}),unknown:new PlatformIcon({iconUrl:"/img/leaflet/marker-icon-unknown.png"})};this.addConnected=function(peers){for(var connected=[],i=0;i<peers.connected.length;i++){var p=peers.connected[i];validLocation(p.location)&&(_.has(this.markers,p.ip)||this.cluster.addLayer(this.markers[p.ip]=L.marker([p.location.latitude,p.location.longitude],{title:p.ipString,icon:platformIcons[p.osBrand.name]}).bindPopup(popupContent(p))),connected.push(p.ip))}this.removeDisconnected(connected),this.map.addLayer(this.cluster)},this.removeDisconnected=function(connected){for(var ip in this.markers)if(!_.contains(connected,ip)){var m=this.markers[ip];this.map.removeLayer(m),this.cluster.removeLayer(m),delete this.markers[ip]}};var validLocation=function(location){return location&&angular.isNumber(location.latitude)&&angular.isNumber(location.longitude)},popupContent=function(p){var content='<p class="ip">'.concat(p.ip,"</p>");return p.location.hostname&&(content+='<p class="hostname">'.concat('<span class="label">Hostname: </span>',p.location.hostname,"</p>")),content+='<p class="version">'.concat('<span class="label">Version: </span>',p.version,"</p>"),content+='<p class="os">'.concat('<span class="label">OS: </span>',p.os,"</p>"),p.location.city&&(content+='<p class="city">'.concat('<span class="label">City: </span>',p.location.city,"</p>")),p.location.region_name&&(content+='<p class="region">'.concat('<span class="label">Region: </span>',p.location.region_name,"</p>")),p.location.country_name&&(content+='<p class="country">'.concat('<span class="label">Country: </span>',p.location.country_name,"</p>")),content}};angular.module("lisk_explorer.tools").factory("networkMonitor",function($socket){return function($scope){var networkMonitor=new NetworkMonitor($scope),ns=$socket("/networkMonitor");return ns.on("data",function(res){res.peers&&networkMonitor.updatePeers(res.peers),res.lastBlock&&networkMonitor.updateLastBlock(res.lastBlock),res.blocks&&networkMonitor.updateBlocks(res.blocks)}),ns.on("data1",function(res){res.lastBlock&&networkMonitor.updateLastBlock(res.lastBlock)}),ns.on("data2",function(res){res.blocks&&networkMonitor.updateBlocks(res.blocks)}),ns.on("data3",function(res){res.peers&&networkMonitor.updatePeers(res.peers)}),$scope.$on("$destroy",function(event){ns.removeAllListeners()}),$scope.$on("$locationChangeStart",function(event,next,current){ns.emit("forceDisconnect")}),networkMonitor}});var OrderBy=function(predicate){this.reverse=!1,this.predicate=predicate,this.order=function(predicate){this.reverse=this.predicate===predicate&&!this.reverse,this.predicate=predicate}};angular.module("lisk_explorer.system").factory("orderBy",function(){return function(predicate){return new OrderBy(predicate)}}),angular.module("lisk_explorer.socket").factory("$socket",function($location,$rootScope){return function(namespace){var socket=io($location.host()+":"+$location.port()+namespace,{forceNew:!0});return{on:function(eventName,callback){socket.on(eventName,function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})})},emit:function(eventName,data,callback){socket.emit(eventName,data,function(){var args=arguments;$rootScope.$apply(function(){callback&&callback.apply(socket,args)})})},removeAllListeners:function(eventName,callback){socket.removeAllListeners(eventName,function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})})}}}}),angular.module("lisk_explorer.system").value("txTypes",{0:"Normal transaction",1:"Second signature creation",2:"Delegate registration",3:"Delegate vote",4:"Multi-signature creation",5:"Dapp registration",7:"Dapp deposit",8:"Dapp withdrawal"}),angular.module("lisk_explorer").filter("approval",function(){return function(votes){return isNaN(votes)?0:(parseInt(votes)/1009e12*100).toFixed(2)}}).filter("epochStamp",function(){return function(d){return new Date(1e3*(Date.UTC(2016,4,24,17,0,0,0)/1e3+d))}}).filter("forgingTime",function(){return function(seconds){if(0===seconds)return"Now!";var minutes=Math.floor(seconds/60);return seconds-=60*minutes,minutes&&seconds?minutes+" min "+seconds+" sec":minutes?minutes+" min ":seconds+" sec"}}).filter("fiat",function(){return function(amount){return isNaN(amount)?(0).toFixed(2):(parseInt(amount)/1e8).toFixed(2)}}).filter("lisk",function(){return function(amount){return isNaN(amount)?(0).toFixed(8):(parseInt(amount)/1e8).toFixed(8).replace(/\.?0+$/,"")}}).filter("currency",function(numberFilter,liskFilter){return function(amount,currency,decimal_places){var lisk=liskFilter(amount),factor=1;if(currency.tickers&&currency.tickers.RISE&&currency.tickers.RISE[currency.symbol])factor=currency.tickers.RISE[currency.symbol];else if("RISE"!==currency.symbol)return"N/A";if(void 0!==decimal_places)return numberFilter(lisk*factor,decimal_places);switch(currency.symbol){case"RISE":case"BTC":return numberFilter(lisk*factor,8).replace(/\.?0+$/,"");default:return numberFilter(lisk*factor,2).replace(/\.?0+$/,"")}}}).filter("nethash",function(){return function(nethash){return"e90d39ac200c495b97deb6d9700745177c7fc4aa80a404108ec820cbeced054c"===nethash?"Testnet":"cd8171332c012514864edd8eb6f68fc3ea6cb2afbaf21c56e12751022684cea5v"===nethash?"Mainnet":"Local"}}).filter("round",function(){return function(height){return isNaN(height)?0:Math.floor(height/101)+(height%101>0?1:0)}}).filter("split",function(){return function(input,delimiter){return delimiter=delimiter||",",input.split(delimiter)}}).filter("startFrom",function(){return function(input,start){return start=+start,input.slice(start)}}).filter("supplyPercent",function(){return function(amount,supply){var supply_check=supply>0;return isNaN(amount)||!supply_check?(0).toFixed(2):(amount/supply*100).toFixed(2)}}).filter("timeAgo",function(epochStampFilter){return function(timestamp){return moment(epochStampFilter(timestamp)).fromNow()}}).filter("timeSpan",function(epochStampFilter){return function(a,b){return moment.duration(epochStampFilter(a)-epochStampFilter(b)).humanize()}}).filter("timestamp",function(epochStampFilter){return function(timestamp){var d=epochStampFilter(timestamp),month=d.getMonth()+1;month<10&&(month="0"+month);var day=d.getDate();day<10&&(day="0"+day);var h=d.getHours(),m=d.getMinutes(),s=d.getSeconds();return h<10&&(h="0"+h),m<10&&(m="0"+m),s<10&&(s="0"+s),d.getFullYear()+"/"+month+"/"+day+" "+h+":"+m+":"+s}}).filter("txSender",function(){return function(tx){return tx.senderDelegate&&tx.senderDelegate.username||tx.senderUsername||tx.knownSender&&tx.knownSender.owner||tx.senderId}}).filter("address",function(){return function(a){return a.username||a.knowledge&&a.knowledge.owner||a.address}}).filter("txRecipient",function(txTypes){return function(tx){return 0===tx.type?tx.recipientDelegate&&tx.recipientDelegate.username||tx.recipientUsername||tx.knownRecipient&&tx.knownRecipient.owner||tx.recipientId:txTypes[parseInt(tx.type)]}}).filter("txType",function(txTypes){return function(tx){return txTypes[parseInt(tx.type)]}}).filter("votes",function(){return function(a){return a.username||a.knowledge&&a.knowledge.owner||a.address}}).filter("proposal",function($sce){return function(name,proposals){var p=_.find(proposals,function(p){return p.name===name.toLowerCase()});return p?$sce.trustAsHtml('<a class="glyphicon glyphicon-user" href="https://forum.lisk.io/viewtopic.php?f=48&t='+p.topic+'" title="'+_.escape(p.description)+'" target="_blank"></a> '+name):$sce.trustAsHtml(name)}}),angular.module("lisk_explorer").config(function($routeProvider){$routeProvider.when("/",{templateUrl:"/views/index.html",title:"Home"}).when("/blocks/:page?",{templateUrl:"/views/blocks.html",title:"Blocks"}).when("/block/:blockId",{templateUrl:"/views/block.html",title:"Block "}).when("/tx/:txId",{templateUrl:"/views/transaction.html",title:"Transaction "}).when("/address/:address",{templateUrl:"/views/address.html",title:"Address"}).when("/activityGraph",{templateUrl:"/views/activityGraph.html",title:"Activity Graph"}).when("/topAccounts",{templateUrl:"/views/topAccounts.html",title:"Top Accounts"}).when("/delegateMonitor",{templateUrl:"/views/delegateMonitor.html",title:"Delegate Monitor"}).when("/marketWatcher",{templateUrl:"/views/marketWatcher.html",title:"Market Watcher"}).when("/networkMonitor",{templateUrl:"/views/networkMonitor.html",title:"Network Monitor"}).otherwise({templateUrl:"/views/404.html",title:"Error"})}),angular.module("lisk_explorer").config(function($locationProvider){$locationProvider.html5Mode(!0),$locationProvider.hashPrefix("!")}).run(function($rootScope,$route,$location,$routeParams,$anchorScroll,$http,ngProgress,gettextCatalog){gettextCatalog.currentLanguage="en",$rootScope.$on("$routeChangeStart",function(){ngProgress.start()}),$rootScope.$on("$routeChangeSuccess",function(){ngProgress.complete(),$rootScope.titleDetail="",$rootScope.title=$route.current.title,$rootScope.isCollapsed=!0,$http.get("/api/exchanges").then(function(result){result.data.success&&result.data.enabled&&($rootScope.marketWatcher=!0)}),$location.hash($routeParams.scrollTo),$anchorScroll()})}),angular.element(document).ready(function(){}),angular.module("lisk_explorer").run(["gettextCatalog",function(gettextCatalog){}]);
